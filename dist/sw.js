self.addEventListener("install",(i=>{console.log("Service Worker installed"),self.skipWaiting()})),self.addEventListener("activate",(i=>(console.log("Service Worker activated"),self.clients.claim()))),self.addEventListener("push",(i=>{console.log("Push notification received",i);let o={};try{i.data&&(o=i.data.json())}catch(i){console.error("Error parsing push notification data:",i),o={title:"Notification",options:{body:"New notification from Story App",icon:"/icons/icon-192x192.png"}}}i.waitUntil(self.registration.showNotification(o.title||"Story App",{body:o.options?.body||"You have a new notification",icon:o.options?.icon||"/icons/icon-192x192.png",badge:o.options?.badge||"/icons/badge-72x72.png",data:o.data||{}}))})),self.addEventListener("notificationclick",(i=>{console.log("Notification clicked",i),i.notification.close(),i.waitUntil(clients.matchAll({type:"window"}).then((o=>{const t=(i.notification.data||{}).url||"/";for(const i of o)if(i.url===t&&"focus"in i)return i.focus();if(clients.openWindow)return clients.openWindow(t)})))}));